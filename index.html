<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="./css/reset.css" media="screen" />
  <link href="https://fonts.googleapis.com/css?family=Space+Mono:400,700" rel="stylesheet">
  <title >JS info:</title>
</head>
<body onresize="drawPage()">

  <div id="displayB">
    <span id="displayBtext">39_characters__________________________</span>
  </div>
  <div id="displayA">
    <span id="displayAtext">18_characters___</span>
  </div>
  <div id="keyboard">
  </div>

<script>
function updateText() {
  let summary = `mode: ${layout} (${hand}) mobile: ${mobile}`;
  while (summary.length < 39) {
    summary = summary + "_";
  }
  displayBtext.innerHTML = summary;
}

function getDisplayData() {
  winInW = window.innerWidth;
  WinOutW = window.outerWidth;
  screenW = screen.width;
  winInH = window.innerHeight;
  WinOutH = window.outerHeight;
  screenH = screen.height;
  winRatio = window.innerWidth / window.innerHeight;
  if (screen.width < window.innerWidth) {
    mobile = true;
  } else {mobile = false;}
}

function setLayout() {
  if (winRatio < 1.2) {
    portrait();
    layout = "portrait";
  } else if (winRatio >= 1.2 && winRatio < 2.1) {
    landscape();
    layout = "landscape";
  }
  else {
    landscapeLong();
    layout = "landscapeLong";
  }
  keyboardHeight = winInH - displayAheight - displayBheight;
  if (layout === "landscapeLong" && mobile === true) {
    numOfKeys = 24;
  } else {
    numOfKeys = 23;
  }

}

function drawPage() {
  getDisplayData();
  setLayout();
  destroyKeys();
  displayB.style.height= `${displayBheight}px`;
  displayA.style.height= `${displayAheight}px`;
  keyboard.style.height= `${keyboardHeight}px`;

  displayB.style.lineHeight = `${displayBheight}px`;
  displayBtext.style.display = "inline-block";
  displayBtext.style.verticalAlign = "middle";
  displayBtext.style.lineHeight = "normal";

  displayA.style.lineHeight = `${displayAheight}px`;
  displayAtext.style.display = "inline-block";
  displayAtext.style.verticalAlign = "middle";
  displayAtext.style.lineHeight = "normal";

  displayAtext.style.fontSize = `${fontSizeA}px`;
  displayBtext.style.fontSize = `${fontSizeB}px`;

  updateText();
  createKeys();
}

function createKeys() {
  for (let i = 0; i < numOfKeys; i++) {
    const key = document.createElement('div');
    key.classList.add('key');
    key.id = i.toString();
    key.style.backgroundColor = "#20272d";
    key.style.border = "1px solid #414e58";

    if (i === 22) {
      if (layout === "portrait") {
        key.style.gridColumn = "3 / span 2";
      } else if (layout === "landscape") {
        key.style.gridColumn = "5 / span 2";
      } else if (mobile === false) {
        key.style.gridColumn = "7 / span 2";
      }
    } else {
      if (layout === "portrait") {
        key.style.gridColumn = `${(i % 4) + 1} / span 1`;
      } else if (layout === "landscape") {
        key.style.gridColumn = `${(i % 6) + 1} / span 1`;
      } else {
        key.style.gridColumn = `${(i % 8) + 1} / span 1`;
      }
    }
    keyboard.appendChild(key);

    // --- text on each key -------------------------
    const keyID = document.createElement('p');
    keyID.classList.add('keyID');
    keyID.id = `keyID${i}`;
    key.appendChild(keyID);
    //-----------------------------------------------
  }
  for (let i = 0; i < numOfKeys; i++) {
    document.getElementById(`keyID${i}`).innerHTML = `${i}`;
    document.getElementById(`keyID${i}`).style.color = "#414e58";
  }
}

function destroyKeys() {
  let elements = document.getElementsByClassName('key');
  while(elements.length > 0){
      elements[0].parentNode.removeChild(elements[0]);
  }
}

function portrait() {
  displayBheight = winInH * (1 / 15);
  displayAheight = winInH * (2 / 15);

  // ------------------ need to adjust for theme -----------
  fontSizeA = winInW / 10;
  fontSizeB = winInW / 26;
}

function landscape() {
  displayBheight = winInH * (1 / 11);
  displayAheight = winInH * (2 / 11);

  // ------------------ need to adjust for theme -----------
  fontSizeA = winInH / 8;
  fontSizeB = winInH / 21;
}

function landscapeLong() {
  displayBheight = winInH * (1 / 9);
  displayAheight = winInH * (2 / 9);

  // ------------------ need to adjust for theme -----------
  fontSizeA = winInH / 7;
  fontSizeB = winInH / 18;
}

let winInW = 0;
let WinOutW = 0;
let screenW = 0;
let winInH = 0;
let WinOutH = 0;
let screenH = 0;
let winRatio = 0;
let mobile = false;
let layout = "portrait"; // 3 options: portrait, landscape, landscapeLong
let hand = "r";

let displayAheight = 0;
let displayBheight = 0;
let keyboardHeight = 0;

let fontSizeA = 0;
let fontSizeB = 0;

let gridRowHeight = 0;
let gridColumns = 0;
let numOfKeys = 0;

let body = document.getElementsByTagName('body')[0];
let para = document.getElementsByTagName('p')[0];
let displayA = document.getElementById('displayA');
let displayB = document.getElementById('displayB');
let displayAtext = document.getElementById('displayAtext');
let keyboard = document.getElementById('keyboard');

body.style.color = "#c0daf1";
body.style.backgroundColor = "#1e272f";
body.style.fontFamily = "'Space+Mono', monospace";

displayB.style.backgroundColor = "#20272d";
displayB.style.textAlign = "right";

displayA.style.backgroundColor = "black";
displayA.style.textAlign = "right";

keyboard.style.backgroundColor = "#11443f";

keyboard.style.display = "grid";
keyboard.style.margin = "auto";

drawPage();

</script>

</body>
</html>
